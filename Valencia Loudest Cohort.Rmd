---
title: "Valencia the Loudest Cohort"
author: "Francisco"
date: "12/6/2019"
output: html_document
---

```{r intro, echo=FALSE, warning=FALSE,message=FALSE}
library(readxl)
library(readxl)
        mydf <- read_excel("german credit card.xls")
        View(mydf)
        
        mydf$purpose<- as.numeric(replace(mydf$purpose,'','X'))[1:1000]
        
        mydf$good_bad <- gsub("good","1",mydf$good_bad)
        mydf$good_bad <- gsub("bad","0",mydf$good_bad)
        mydf$good_bad <- as.numeric(mydf$good_bad)

for (i in 1:nrow(mydf)){
  if (mydf$good_bad[i] == 1){
    mydf$description[i] <- 'positive'
  }else{
    mydf$description[i] <- 'negative'
  }
}

logit_ger <- glm(good_bad~age+amount+savings+duration+checking, data = mydf, family = 'binomial')
summary(logit_ger)


"Hey hey senior leaders this is your business insight
The age is important becuse when I get older by one year the odds of becoming bad icnrease by 1.5%
The duration is also important.... "
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the *Knit* button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


```{r tree, echo=FALSE}
library(rpart)
library(rpart.plot)
tree_ger<- rpart(good_bad~age+amount+savings+duration+checking,
                 data=german_credit_card, method="class")

rpart.plot(tree_ger, extra=1, type=1)


"Amount is more imortant from a business standpoint on the tree but insignificant in the logistic regression.
The age is important froma  business standpoint in the logistic regression but less important in the tree."
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
install.packages("plotly")
library(plotly)
#age vs. good_Bad
p<-plot_ly(data=mydf, x=~age, y=~good_bad)
p

library(ggplot2)
q <- ggplot(mydf, aes(x=age, y=good_bad)) +
  geom_jitter((aes(color=checking)))
q
ggplotly(q)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
